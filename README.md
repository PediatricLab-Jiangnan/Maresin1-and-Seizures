Code by Ruijin Xie
TPM File also added
